---
title: "POCO F7でadbを使って不要なアプリを消す"
emoji: "🦔"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: ["スマホ", "Xiaomi"]
published: true
---

# 新しいスマホを購入したけど要らないアプリを消したい

Xiaomi POCO F7というスマートフォンを購入したのですが、ゲームセンターなど普段使いに必要のないアプリが最初からインストールされている上に、一度起動してしまうと通知を汚しに来たりするアプリが多いので削除することにしました。

ネット上で調べてみると、同じように初期アプリを削除する人はたくさんいるようで、基本的には

- PCにadbコマンドをダウンロードする
- 開発者オプションを有効にする
- USBデバッグを有効にする
- Xiaomiアカウントをログイン状態にする
- PCと接続してファイル転送モードにしたあとadbコマンドを実行

という手順でできるようです。

参考サイト

https://note.com/munyoru/n/naf0aae64fa7b

ただ、どうやってもadbがスマホを認識せず、調べてみると以下のような情報を見つけました。

https://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q10317545960

ADB専用のドライバーがいるとか？そしてPOCO F7で使えドライバーはまだない？？？
それは困ったなと思って読み進めると質問者さんが「ワイヤレスデバッグで回避した」とのこと。

というわけでケーブルを外してワイヤレスデバッグを有効にしたら私の環境でもadb接続できました。

# 実際に消したアプリ

とりあえず以下のアプリを削除しました。対応するコマンドも並べてあります。

トラブル時の対処・報告
```bash
adb shell pm uninstall --user 0 com.miui.miservice
```

MIUIミュージック
```bash
adb shell pm uninstall --user 0 com.miui.player
```

MIビデオ
```bash
adb shell pm uninstall --user 0 com.miui.videoplayer
```

ゲームセンター
```bash
adb shell pm uninstall --user 0 com.xiaomi.glgm
```

GoogleOne
```bash
adb shell pm uninstall --user 0 com.google.android.apps.subscriptions.red
```

GoogleTV
```bash
adb shell pm uninstall --user 0 com.google.android.videos
```

MIUIブラウザ
```bash
adb shell pm uninstall --user 0 com.mi.globalbrowser
```

# 具体的なセットアップ手順

以下、Geminiによるセットアップ手順の紹介です。

## **`adb.exe`を使うための一般的な準備**

ほとんどのAndroidスマートフォンで共通の手順です。

**1. PC側の準備**

  * **Android SDK Platform Toolsのインストール**:

      * Googleの公式ページから「[SDK Platform Tools](https://developer.android.com/tools/releases/platform-tools)」をダウンロードします。
      * ダウンロードしたzipファイルを解凍し、任意の場所に保存してください（例: `C:\platform-tools`）。
      * このフォルダ内に`adb.exe`が含まれています。

  * **PCの環境変数PATHの設定（推奨）**:

      * これにより、コマンドプロンプトやPowerShellのどのディレクトリからでも`adb`コマンドを実行できるようになります。
      * 設定方法がわからない場合は、`platform-tools`フォルダ内でコマンドプロンプトを開いて作業することも可能です。

**2. POCOスマートフォン側の準備**

  * **開発者向けオプションの有効化**:

    1.  スマートフォンの「設定」アプリを開きます。
    2.  「デバイス情報」または「端末情報」を探します。
    3.  「MIUIバージョン」や「ビルド番号」を7回連続でタップします。
    4.  「これで開発者になりました！」というメッセージが表示されます。

  * **USBデバッグの有効化**:

    1.  「設定」アプリに戻ります。
    2.  「追加設定」または「システム」を探します。
    3.  「開発者向けオプション」をタップします。
    4.  「USBデバッグ」を探し、オンに切り替えます。

**3. PCとスマートフォンをUSBケーブルで接続**

  * USBケーブルでPCとスマートフォンを接続します。
  * スマートフォン側で「USBの使用」または「USB設定」の通知が表示されたら、「ファイル転送」または「PTP（写真転送）」を選択してください。
  * **注意**: 接続時に「このPCを許可しますか？」といったポップアップが表示されたら、必ず「許可」または「OK」をタップしてください。この操作をしないと、`adb`からの接続が確立できません。

**4. `adb.exe`の動作確認**

1.  PCでコマンドプロンプトまたはPowerShellを開きます。
2.  `platform-tools`フォルダに移動します。
      * `cd C:\platform-tools`
3.  以下のコマンドを実行します。
    ```bash
    adb devices
    ```
4.  以下のように、接続されたデバイスが表示されれば成功です。
    ```bash
    List of devices attached
    xxxxxxxxxxxxxxx   device
    ```

もし`offline`と表示された場合は、スマートフォン側の「USBデバッグを許可しますか？」のポップアップを見落としている可能性があります。一度ケーブルを抜き差しして再度確認してみてください。

:::message
おそらくデバイスが見つからないと思うので、次の説明を参考にワイヤレスデバッグによる接続を試してください
:::

## ワイヤレスデバッグの設定

**準備**

  * PCとスマートフォンが**同じWi-Fiネットワークに接続**されていることを確認してください。

**手順**

### 1\. スマートフォン側の設定

1.  **開発者向けオプションを有効にする**

      * 以前の回答で説明した通り、「設定」→「デバイス情報」→「MIUIバージョン」を7回タップして開発者向けオプションを有効にします。

2.  **ワイヤレスデバッグをオンにする**

      * 「設定」→「追加設定」→「開発者向けオプション」に進みます。
      * \*\*「ワイヤレスデバッグ」\*\*の項目を探してオンにします。
      * オンにすると、Wi-Fiネットワークに接続されていることを確認するポップアップが表示されることがあります。

3.  **デバイスのペアリング**

      * 「ワイヤレスデバッグ」の項目をタップして、詳細画面に入ります。
      * 表示される2つのオプションのうち、\*\*「ペア設定コードによるデバイスのペア設定」\*\*をタップします。
      * 新しい画面に、**IPアドレスとポート番号**（例: `192.168.1.100:45678`）と、**6桁のペア設定コード**が表示されます。この情報をPC側で使いますので、画面を開いたままにしておきます。

### 2\. PC側の操作

1.  **コマンドプロンプト（またはPowerShell）を開く**

      * `adb.exe`がある`platform-tools`フォルダ内で開いてください。

2.  **ペアリングの実行**

      * スマートフォンの画面に表示されている「IPアドレス:ポート番号」と「ペア設定コード」を使って、以下のコマンドを実行します。
      * `<IPアドレス:ポート番号>`と`<ペア設定コード>`の部分は、スマートフォンの画面に表示されている情報に置き換えてください。

    <!-- end list -->

    ```bash
    adb pair <IPアドレス:ポート番号>
    ```

      * コマンドを実行すると、「Enter pair code:」と表示されます。
      * ここで、スマートフォンの画面に表示されている6桁のペア設定コードを入力してEnterキーを押します。
      * 「Successfully paired to \<IPアドレス:ポート番号\>」というメッセージが表示されれば、ペアリングは成功です。

3.  **ワイヤレスでの接続**

      * ペアリングが完了したら、スマートフォンの「ワイヤレスデバッグ」画面に戻ります。
      * 「IPアドレスとポート」という項目に、ペアリング時とは**異なる新しいポート番号**が表示されているはずです。（例: `192.168.1.100:54321`）
      * この新しいIPアドレスとポート番号を使って、以下のコマンドを実行します。

    <!-- end list -->

    ```bash
    adb connect <IPアドレス:ポート番号>
    ```

      * 「connected to \<IPアドレス:ポート番号\>」と表示されれば、ワイヤレス接続は完了です。

4.  **動作確認**

      * 以下のコマンドを実行して、接続されているデバイスのリストに表示されるか確認します。

    <!-- end list -->

    ```bash
    adb devices
    ```

      * 以下のように、接続したデバイスが`device`として表示されれば成功です。

    <!-- end list -->

    ```
    List of devices attached
    192.168.1.100:54321    device
    ```


## トラブルシューティング

### **接続が安定しない、`offline`になる**
  * PCとスマートフォンが本当に同じWi-Fiネットワークに接続されているか再確認してください。
  * ファイアウォールやセキュリティソフトが`adb`接続をブロックしていないか確認してください。
  * ルーターのプライバシーセパレーター機能が有効になっている場合、同じネットワーク内の機器同士の通信が遮断されることがあります。この機能をオフにしてみてください。
### **ポート番号が変わってしまう**
  * これはAndroidの仕様です。ワイヤレスデバッグは一時的なポートを使用するため、スマートフォンを再起動したり、Wi-Fiの接続を切り替えるとポート番号が変わることがあります。その都度、新しいポート番号で`adb connect`を実行し直す必要があります。

### スマートフォンのADB認証を再試行する（有線接続の場合）

PCとスマートフォンを初めてADB接続する際、スマートフォン側で「このPCからのUSBデバッグを許可しますか？」という確認画面（RSAキー認証）が表示されます。これが表示されず、デバイスが`unauthorized`（未認証）の状態になっている場合は以下の手順を実行します。

**手順：**

1.  **既存の認証を解除する**
      * スマートフォンの「設定」アプリを開きます。
      * 「追加設定」→「開発者向けオプション」に進みます。
      * \*\*「USBデバッグの承認を取り消す」\*\*という項目を探してタップします。これで、既存のすべての認証がリセットされます。
2.  **再接続と認証**
      * USBケーブルを一度抜き差しします。
      * このとき、スマートフォンの画面ロックを解除した状態で操作してください。
      * 画面に\*\*「このPCからのUSBデバッグを許可しますか？」\*\*というポップアップが表示されるはずです。
      * 「このコンピューターからの接続を常に許可する」にチェックを入れ、「OK」または「許可」をタップします。
3.  **`adb`サーバーのリセット**
      * PCのコマンドプロンプトで、以下のコマンドを実行します。
    <!-- end list -->
    ```bash
    adb kill-server
    adb start-server
    ```
      * その後、`adb devices`を実行して、デバイスが認識されるか確認します。

###  USBケーブルやポートを変えてみる

ファイル転送はできても、ADB接続に必要なデータ通信が不安定な場合があります。

  * **USBポートの変更**: PCの別のUSBポート（特に、マザーボード直結の背面ポート）に接続してみてください。
  * **USBケーブルの変更**: 付属の純正ケーブルや、データ通信に対応した高品質なUSBケーブルに交換してみてください。安価な充電専用ケーブルでは、ADB接続ができません。




